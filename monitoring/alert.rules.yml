groups:
- name: mlops-alerts
  rules:
  # Latency Alert
  - alert: HighRequestLatency
    expr: rag_processing_seconds_sum / rag_processing_seconds_count > 5
    for: 1m
    labels:
      severity: warning
    annotations:
      summary: "High RAG Request Latency"
      description: "Average RAG request processing time is > 5s (current value: {{ $value }}s)"

  # Error Rate Alert
  - alert: HighErrorRate
    expr: rate(rag_request_total{status="error"}[5m]) > 0
    for: 1m
    labels:
      severity: critical
    annotations:
      summary: "High RAG Error Rate"
      description: "RAG requests are failing"

  # Faithfulness Alert
  - alert: LowFaithfulness
    expr: rag_metric_faithfulness < 0.7
    for: 5m
    labels:
      severity: warning
    annotations:
      summary: "Low RAG Faithfulness"
      description: "RAG Faithfulness score is below 0.7 (current value: {{ $value }})"

  # Instance Down
  - alert: InstanceDown
    expr: up == 0
    for: 1m
    labels:
      severity: critical
    annotations:
      summary: "Instance {{ $labels.instance }} down"
      description: "{{ $labels.instance }} of job {{ $labels.job }} has been down for more than 1 minute."
